<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Shimoda Lodging Investment – USD Pro Forma (with FX) – v2</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 24px; line-height: 1.5; color: #0b0b0b; }
  header { margin-bottom: 16px; }
  h1 { font-size: 1.6rem; margin: 0 0 8px 0; }
  h2 { font-size: 1.25rem; margin-top: 24px; }
  .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; }
  .card { border: 1px solid #e5e5e5; border-radius: 8px; padding: 16px; background: #fff; }
  label { display: block; font-weight: 600; font-size: 0.9rem; }
  input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; margin-top: 6px; }
  small { color: #585858; }
  .muted { color: #555; }
  .kpi { font-size: 1.2rem; font-weight: 700; }
  table { width: 100%; border-collapse: collapse; margin-top: 8px; }
  th, td { padding: 8px 6px; border-bottom: 1px dashed #e2e2e2; text-align: right; }
  th { text-align: left; }
  .row { display:flex; gap:8px; align-items: center; flex-wrap: wrap; }
  .pill { display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid #bbb; font-size:0.9rem; cursor:pointer; user-select:none; }
  .pill.active { border-color:#111; box-shadow: 0 0 0 2px rgba(0,0,0,0.06) inset; font-weight:700; }
  a.listing { text-decoration: none; border-bottom: 1px dashed #888; }
  .fxnote{font-size:0.9rem; color:#444;margin-top:6px}
  footer { margin-top: 28px; font-size: 0.9rem; }
  code { background:#f5f5f5; padding:2px 6px; border-radius: 4px; }
</style>
</head>
<body>
<header>
  <h1>Shimoda Lodging Investment – USD Pro Forma (with FX)</h1>
  <div class="muted">
    Asset: <strong>S1737Z 柿崎中古ホテル</strong> · 下田市柿崎 · 404.44㎡（延床） · 8客室 · 1974年築 · 改装2019年（R1） · 
    <a class="listing" href="https://www.izumirai.com/bkndetail/3966776075/room97540665/" target="_blank">View Listing</a>
  </div>
  <div class="row" style="margin-top:8px;">
    <div id="tab_hotel" class="pill active">Hotel</div>
    <div id="tab_minpaku" class="pill">Minpaku (180d)</div>
    <div id="tab_flip" class="pill">Flip</div>
  </div>
  <div class="muted" style="margin-top:6px;">Click a scenario to drive exit/IRR math below.</div>
</header>

<section class="grid">
  <div class="card">
    <h2>FX & Display</h2>
    <label>FX Rate (JPY per 1 USD)<input id="fx" type="number" value="150" step="0.5"></label>
    <label>Show JPY equivalents?
      <select id="show_jpy">
        <option value="yes" selected>Yes</option>
        <option value="no">No</option>
      </select>
    </label>
  </div>

  <div class="card">
    <h2>Acquisition & CapEx (USD)</h2>
    <label>Purchase Price ($)<input id="price_usd" type="number" value="532000" step="5000"></label>
    <label>Closing + Soft Costs (%)<input id="soft" type="number" value="3" step="0.5"></label>
    <label>Renovation / Upgrades ($)<input id="reno_usd" type="number" value="135000" step="5000"></label>
    <label>Rooms (keys)<input id="keys" type="number" value="8" step="1"></label>
  </div>

  <div class="card">
    <h2>Operations – Hotel License</h2>
    <label>ADR ($/room-night)<input id="adr_hotel" type="number" value="160"></label>
    <label>Occupancy (%)<input id="occ_hotel" type="number" value="60"></label>
    <label>Opex (% of rev)<input id="opex" type="number" value="55"></label>
    <label>Mgmt/OTA (% of rev)<input id="mgmt" type="number" value="12"></label>
  </div>

  <div class="card">
    <h2>Operations – Minpaku (180d)</h2>
    <label>ADR ($/room-night)<input id="adr_minpaku" type="number" value="175"></label>
    <label>Occupancy (%)<input id="occ_minpaku" type="number" value="65"></label>
  </div>

  <div class="card">
    <h2>Financing</h2>
    <label>LTV (%)<input id="ltv" type="number" value="70"></label>
    <label>Interest Rate (% p.a.)<input id="rate" type="number" value="2.2"></label>
    <label>Amortization (yrs)<input id="amort" type="number" value="20"></label>
  </div>
</section>

<section class="grid">
  <div class="card" id="card_hotel">
    <h2>Hotel Results</h2>
    <div id="kpi_hotel" class="kpi">—</div>
    <table id="table_hotel"></table>
  </div>
  <div class="card" id="card_minpaku">
    <h2>Minpaku Results</h2>
    <div id="kpi_minpaku" class="kpi">—</div>
    <table id="table_minpaku"></table>
  </div>
  <div class="card">
    <h2>Flip Settings</h2>
    <label>Buyer Exit Cap Rate (%)<input id="flip_exitcap" type="number" value="8"></label>
    <label>Months to Sale<input id="flip_months" type="number" value="12"></label>
  </div>
  <div class="card">
    <h2>Exit / IRR (Driven by Active Scenario)</h2>
    <label>Exit Cap Rate (%)<input id="exitcap" type="number" value="8"></label>
    <label>Annual Value Growth (%)<input id="growth" type="number" value="1.5"></label>
    <div id="kpi_exit" class="kpi">—</div>
    <table id="table_exit"></table>
  </div>
</section>

<footer class="muted">Educational use only; not financial advice.</footer>

<script>
let scenario='hotel';
function fmtUSD(x){return '$'+x.toLocaleString('en-US',{maximumFractionDigits:0});}
function fmtJPY(x){return '¥'+x.toLocaleString('ja-JP');}
function mortgagePayment(p, rA, y){const r=rA/100/12,n=y*12;return p*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1);}
function maybeJPY(v){const fx=+fxEl.value;return showEl.value==='yes'?' <span class="muted">('+fmtJPY(Math.round(v*fx))+')</span>':'';}
const fxEl=document.getElementById('fx');const showEl=document.getElementById('show_jpy');
['tab_hotel','tab_minpaku','tab_flip'].forEach(id=>{document.getElementById(id).onclick=()=>{scenario=id.split('_')[1];['tab_hotel','tab_minpaku','tab_flip'].forEach(i=>document.getElementById(i).classList.toggle('active',i===id));compute();};});
function compute(){const fx=+fxEl.value;
const price=+price_usd.value,soft=+soft.value,reno=+reno_usd.value,keys=+keys.value;
const adrH=+adr_hotel.value,occH=+occ_hotel.value/100,adrM=+adr_minpaku.value,occM=+occ_minpaku.value/100,opexR=+opex.value/100,mgmtR=+mgmt.value/100;
const ltv=+ltv.value/100,rate=+rate.value,amort=+amort.value,exitcap=+exitcap.value/100,growth=+growth.value/100,flipCap=+flip_exitcap.value/100,flipMonths=+flip_months.value;
const softCost=price*soft/100,total=price+softCost+reno,loan=total*ltv,equity=total-loan,ds=mortgagePayment(loan,rate,amort)*12;
const rnH=keys*365*occH,revH=rnH*adrH,opH=revH*(opexR+mgmtR),noiH=revH-opH,cfH=noiH-ds;
const rnM=keys*180*occM,revM=rnM*adrM,opM=revM*(opexR+mgmtR),noiM=revM-opM,cfM=noiM-ds;
kpi_hotel.innerHTML=`NOI ${fmtUSD(noiH)}${maybeJPY(noiH)} · CoC ${(cfH/equity*100).toFixed(1)}%`;
table_hotel.innerHTML=`<tr><th>Revenue</th><td>${fmtUSD(revH)}${maybeJPY(revH)}</td></tr><tr><th>NOI</th><td>${fmtUSD(noiH)}${maybeJPY(noiH)}</td></tr>`;
kpi_minpaku.innerHTML=`NOI ${fmtUSD(noiM)}${maybeJPY(noiM)} · CoC ${(cfM/equity*100).toFixed(1)}%`;
table_minpaku.innerHTML=`<tr><th>Revenue</th><td>${fmtUSD(revM)}${maybeJPY(revM)}</td></tr><tr><th>NOI</th><td>${fmtUSD(noiM)}${maybeJPY(noiM)}</td></tr>`;
let baseNOI=scenario==='hotel'?noiH:scenario==='minpaku'?noiM:Math.max(noiH,noiM);
let irr,exitV,sell,balA,net;
if(scenario!=='flip'){const n5=baseNOI*Math.pow(1+growth,4);exitV=n5/exitcap;sell=exitV*0.03;
const m=mortgagePayment(loan,rate,amort),r=rate/100/12,N=amort*12,paid=60;balA=loan*Math.pow(1+r,N)-m*(Math.pow(1+r,paid)-1)/r;
net=exitV-sell-balA;
function irrB(c0,cf,term){let lo=-.9,hi=1;for(let i=0;i<60;i
